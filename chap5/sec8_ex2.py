def ensure_book(book: str, text: str):
    miss = []
    for c in text:
        if c not in book:
            miss.append(c)

    return book + "".join(miss)


gen_decode_keys = lambda book, cipher_text: {
    s: book[int(s)] for s in cipher_text.split("*")
}

book = "In a village in La Mancha, the name of which I cannot quite recall, there lived not long ago one of those country gentlemen or hidalgos who keep a lance in a rack, an ancient leather shield, a scrawny hack and a greyhound for coursing. A midday stew with rather more shin of beef than leg of lamb, the leftovers for supper most nights, lardy eggs on Saturdays, lentil broth on Fridays and an occasional pigeon as a Sunday treat ate up three-quarters of his income. The rest went on a cape of black broadcloth, with breeches of velvet and slippers to match for holy days, and on weekdays he walked proudly in the finest homespun. He maintained a housekeeper the wrong side of forty, a niece the right side of twenty and a jack of all trades who was as good at saddling the nag as at plying the pruning shears. Our hidalgo himself was nearly fifty; he had a robust constitution, dried-up flesh and a withered face, and he was an early riser and a keen huntsman. His surname’s said to have been Quixada, or Quesada (as if he were a jawbone, or a cheesecake): concerning this detail there’s some discrepancy among the authors who have written on the subject, although a credible conjecture does suggest he might have been a plaintive Quexana. But this doesn’t matter much, as far as our story’s concerned, provided that the narrator doesn’t stray one inch from the truth.Now you must understand that during his idle moments (which accounted for most of the year) this hidalgo took to reading books of chivalry with such relish and enthusiasm that he almost forgot about his hunting and even running his property, and his foolish curiosity reached such extremes that he sold acres of arable land to buy these books of chivalry, and took home as many of them as he could find;1 he liked none of them so much as those by the famous Feliciano de Silva,2 because the brilliance of the prose and all that intricate language seemed a treasure to him, never more so than when he was reading those amorous compliments and challenges delivered by letter, in which he often found: ‘The reason for the unreason to which my reason is subjected, so weakens my reason that I have reason to complain of your beauty.’ And also when he read: ‘... the lofty heavens which with their stars divinely fortify you in your divinity, and make you meritorious of the merits merited by your greatness.’ Such subtleties used to drive the poor gentleman to distraction, and he would rack his brains trying to understand it all and unravel its meaning, something that Aristotle himself wouldn’t have been capable of doing even if he’d come back to life for this purpose alone. He wasn’t very happy about the wounds that Sir Belianis kept on inflicting and receiving, because he imagined that, however skilful the doctors who treated him, his face and body must have been covered with gashes and scars. But, in spite of all that, he commended the author for ending his book with that promise of endless adventure, and often felt the urge to take up his quill and bring the story to a proper conclusion, as is promised there; and no doubt he’d have done so, and with success too, if other more important and insistent preoccupations hadn’t prevented him. He had frequent arguments with the village priest (a learned man — a Sigiienza graduate no less) about which had been the better knight errant, Palmerin of England3 or Amadis of Gaul; but Master Nicolás, the village barber, argued that neither of them could hold a candle to the Knight of Phoebus, and that if anyone at all could be compared to him it was Don Galaor, Amadis of Gaul’s brother, because there was no emergency he couldn’t cope with: he wasn’t one of your pernickety knights, nor was he such a blubberer as his brother, and he was every bit his equal as far as courage was concerned.In short, our hidalgo was soon so absorbed in these books that his nights were spent reading from dusk till dawn, and his days from dawn till dusk, until the lack of sleep and the excess of reading withered his brain, and he went mad. Everything he read in his books took possession of his imagination: enchantments, fights, battles, challenges, wounds, sweet nothings, love affairs, storms and impossible absurdities. The idea that this whole fabric of famous fabrications was real so established itself in his mind that no history in the world was truer for him. He would declare that El Cid, Ruy Diaz, had been an excellent knight, but that he couldn’t be compared to the Knight of the Burning Sword,4 who with just one back-stroke had split two fierce and enormous giants clean down the middle. He felt happier about Bernardo del Carpio, because he’d slain Roland the Enchanted at Roncesvalles, by the same method used by Hercules when he suffocated Antaeus, the son of Earth — with a bear-hug.5 He was full of praise for the giant Morgante because, despite belonging to a proud and insolent breed, he alone was affable and well-mannered.6 But his greatest favourite was Reynald of Montalban,7 most of all when he saw him sallying forth from his castle and plundering all those he met, and when in foreign parts he stole that image of Muhammad made of solid gold, as his history records. He’d have given his housekeeper, and even his niece into the bargain, to trample the traitor Ganelon in the dust.8And so, by now quite insane, he conceived the strangest notion that ever took shape in a madman’s head, considering it desirable and necessary, both for the increase of his honour and for the common good, to become a knight errant, and to travel about the world with his armour and his arms and his horse in search of adventures, and to practise all those activities that he knew from his books were practised by knights errant, redressing all kinds of grievances, and exposing himself to perils and dangers that he would overcome and thus gain eternal fame and renown. The poor man could already see himself being crowned Emperor of Trebizond, at the very least, through the might of his arm; and so, possessed by these delightful thoughts and carried away by the strange pleasure that he derived from them, he hastened to put into practice what he so desired.His first step was to clean a suit of armour that had belonged to his forefathers and that, covered in rust and mould, had been standing forgotten in a corner for centuries. He scoured and mended it as best he could; yet he realized that it had one important defect, which was that the headpiece was not a complete helmet but just a simple steel cap; he was ingenious enough, however, to overcome this problem, constructing out of cardboard something resembling a visor and face-guard which, once inserted into the steel cap, gave it the appearance of a full helmet. It’s true that, to test its strength and find out whether it could safely be exposed to attack, he drew his sword and dealt it two blows, with the first of which he destroyed in a second what it had taken him a week to create. He couldn’t help being concerned about the ease with which he’d shattered it, and to guard against this danger he reconstructed it, fixing some iron bars on the inside, which reassured him about its strength; and, preferring not to carry out any further tests, he deemed and pronounced it a most excellent visored helmet.Then he went to visit his nag, and although it had more corns than a barleyfield and more wrong with it than Gonella’s horse, which tantum pellis et ossa fuit,9 it seemed to him that neither Alexander’s Bucephalus nor the Cid’s Babieca was its equal. He spent four days considering what name to give the nag; for (he told himself) it wasn’t fitting that the horse of such a famous knight errant, and such a fine horse in its own right, too, shouldn’t have some name of eminence; and so he tried to find one that would express both what it had been before it became a knight’s horse and what it was now, for it was appropriate that, since its master had changed his rank, it too should change its name, and acquire a famous and much-trumpeted one, as suited the new order and new way of life he professed. And so, after a long succession of names that he invented, eliminated and struck out, added, deleted and remade in his mind and in his imagination, he finally decided to call it Rocinante, that is, Hackafore, a name which, in his opinion, was lofty and sonorous and expressed what the creature had been when it was a humble hack, before it became what it was now — the first and foremost of all the hacks in the world. Having given his horse a name, and one so much to his liking, he decided to give himself a name as well, and this problem kept him busy for another eight days, at the end of which he decided to call himself Don Quixote, that is, Sir Thighpiece, from which, as has already been observed, the authors of this most true history concluded that his surname must have been Quixada, and not Quesada as others had affirmed. Yet remembering that brave Amadis hadn’t been content to call himself Amadis alone, but had added the name of his kingdom and homeland, to make it famous, and had styled himself Amadis of Gaul, so Don Quixote, as a worthy knight, decided to add his own country to his name and call himself Don Quixote de la Mancha, by doing which, in his opinion, he declared in a most vivid manner both his lineage and his homeland, and honoured the latter by taking it as his surname. Having, then, cleaned his armour, turned his steel cap into a visored helmet, baptized his nag and confirmed himself, he realized that the only remaining task was to find a lady of whom he could be enamoured; for a knight errant without a lady-love is a tree without leaves or fruit, a body without a soul. He said to himself: ‘If, for my wicked sins or my good fortune, I encounter some giant, as knights errant usually do, and I dash him down in single combat, or cleave him asunder, or, in short, defeat and vanquish him, will it not be proper to have someone to whom I can send him as a tribute, so that he can come before my sweet lady and fall to his knees and say in humble tones of submission: “I, my lady, am the giant Caraculiambro,10 the Lord of the Isle of Malindrania, vanquished in single combat by the never sufficiently praised knight Don Quixote de la Mancha, who has commanded me to present myself before Your Highness so that Your Highness may dispose of me as you will”?’ Oh my, how our worthy knight rejoiced once he’d spoken these words - even more, once he’d found someone he could call his lady! The fact was — or so it is generally believed - that in a nearby village there lived a good-looking peasant girl, with whom he’d once been in love (although it appears that she was never aware of this love, about which he never told her). She was called Aldonza Lorenzo, and this was the woman upon whom it seemed appropriate to confer the title of the lady of his thoughts; and seeking a name with some affinity with his own, which would also suggest the name of a princess and a fine lady, he decided to call her Dulcinea del Toboso, because she was a native of El Toboso: a name that, in his opinion, was musical and magical and meaningful, like all the other names he’d bestowed upon himself and his possessions."

message = "22*13*33*137*59*11*23*11*1*57*6*13*1*2*6*57*2*6*1*22*13*33*137*59*11*23*11*1*57*6*173*7*11"

print("".join(gen_decode_keys(book, message).values()))
